name: "2025 desktop DSC packages CI workflow"

on:
  push:
    branches: [ test ]
  schedule:
    - cron: '39 11 * * *'

jobs:
  windows-2025-pwsh-dsc:
    name: "2025 DSC packages"
    runs-on: windows-2025
    steps:
    - name: Checkout
      uses: actions/checkout@v1
    
    - name: Install DSC Modules
      run: |
        Install-Module -Name PSDscResources, cChoco -Force
      shell: pwsh
      
    - name: Compile DSC Configuration
      run: |
        # This command runs your script and creates the 'DesktopPackages' directory.
        .\scripts\Apply_DSC_Desktop_Config.ps1
      shell: pwsh
      
    - name: Apply DSC Configuration
      run: |
        # This command applies the compiled configuration from the 'DesktopPackages' directory.
        Start-DscConfiguration -Path .\DesktopPackages -Wait -Verbose
      shell: pwsh